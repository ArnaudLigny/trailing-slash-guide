<html>
<body>
  <script>
      async function testUrl(url) {
        const response = await fetch(
                url,
                // {redirect: 'manual'}
        )
        console.log("response", {url,response});
        return {
          status: response.status,
          redirectTo: response.redirected ? new URL(response.url).pathname : undefined
          // redirectLocation: response.headers.get("Location")
        };
      }

      async function processUrl(url) {
        const result = await testUrl(url);
        console.log("processUrl",{url,result});

        const div = document.createElement("div");
        const a = document.createElement('a');
        a.appendChild(document.createTextNode(url));
        a.href = url;

        const text = result.redirectTo ? ` => ${result.redirectTo}` : " => no redirect"
        div.appendChild(a);
        div.appendChild(document.createTextNode(text));

        document.body.appendChild(div);
      }


      async function run() {
        const Urls = [
          "/file",
          "/file/",
          "/folder",
          "/folder/",
          "/both",
          "/both/",
        ];
        for (const url of Urls) {
          await processUrl(url);
        }
      }

      run().catch(e => {
        console.error(e);
        alert("Error, check the console: " + e.message);
      });

  </script>
</body>
</html>
